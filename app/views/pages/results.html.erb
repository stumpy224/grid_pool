<% provide(:title, 'Results') %>
<div align='center' id='results_page'>
  <div class="panel panel-default">
    <div class="panel-heading" style="font-size:2em;"><%= $year %> Results</div>
    <div class="panel-body">
      <% if @payouts.exists? %>
      <% if @participants_with_squares.any? %>
      <% if @results.count < 63 %>
      <div>
        <% last_updated_at = @years.find_by(year: $year).results_last_updated_at %>
        <% if !last_updated_at.blank? %>
        <%= last_updated_at.strftime('Last updated: %m/%d/%Y at %I:%M %p') %>
        <% end %>
      </div>
      <div>
        <%= link_to 'Refresh', refresh_results_path, id: 'refresh_results_link', remote: true, class: 'btn btn-primary' %>
      </div>
      <% end %>
        <div class="col-lg-4 col-md-4 col-sm-4">
          <div class="panel panel-default">
            <div class="panel-heading">
              <h3 class="panel-title">Al Borland</h3>
            </div>
            <div class="panel-body" style="margin-bottom:-1.3em;">
              <div class="col-lg-7 col-md-7 col-sm-7">
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h3 class="panel-title">4 Squares</h3>
                  </div>
                  <table class="table table-condensed">
                    <thead>
                      <tr>
                        <th style="text-align:center;">W</th>
                        <th style="text-align:center;">L</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>0</td>
                        <td>0</td>
                      </tr>
                      <tr>
                        <td>0</td>
                        <td>1</td>
                      </tr>
                      <tr>
                        <td>0</td>
                        <td>2</td>
                      </tr>
                      <tr>
                        <td>0</td>
                        <td>3</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
              <div>
                <form class="form-inline">
                  <div class="form-group">
                    <label>Won:</label>
                    <label style="font-weight:normal;">$23</label>
                  </div>
                </form>
              </div>
              <div>
                <form class="form-inline">
                  <div class="form-group">
                    <label>Paid:</label>
                    <label style="font-weight:normal;">$20</label>
                  </div>
                </form>
              </div>
              <div>
                <form class="form-inline">
                  <div class="form-group">
                    <label>Profit:</label>
                    <label style="font-weight:normal;">$3</label>
                  </div>
                </form>
              </div>
              <div>
                    <label>Rounds:</label>
              </div>
              <div>
                    <label style="font-weight:normal;">2, 3, 4, 6</label>
              </div>
            </div>
          </div>
        </div>
      <div class="col-lg-4 col-md-4 col-sm-4">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Another Test</h3>
          </div>
          <div class="panel-body">
            <div class="col-lg-7 col-md-7 col-sm-7">
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h3 class="panel-title">4 Squares</h3>
                  </div>
                  <table class="table table-condensed">
                    <thead>
                      <tr>
                        <th style="text-align:center;">W</th>
                        <th style="text-align:center;">L</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>0</td>
                        <td>0</td>
                      </tr>
                      <tr>
                        <td>0</td>
                        <td>1</td>
                      </tr>
                      <tr>
                        <td>0</td>
                        <td>2</td>
                      </tr>
                      <tr>
                        <td>0</td>
                        <td>3</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
              <div>
                <form class="form-inline">
                  <div class="form-group">
                    <label>Won:</label>
                    <label style="font-weight:normal;">$23</label>
                  </div>
                </form>
              </div>
              <div>
                <form class="form-inline">
                  <div class="form-group">
                    <label>Paid:</label>
                    <label style="font-weight:normal;">$20</label>
                  </div>
                </form>
              </div>
              <div>
                <form class="form-inline">
                  <div class="form-group">
                    <label>Profit:</label>
                    <label style="font-weight:normal;">$3</label>
                  </div>
                </form>
              </div>
              <div>
                    <label>Rounds:</label>
              </div>
              <div>
                    <label style="font-weight:normal;">2, 3, 4, 6</label>
              </div>
          </div>
        </div>
      </div>
      <div class="col-lg-4 col-md-4 col-sm-4">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Hunter Mahan</h3>
          </div>
          <div class="panel-body">
            <div class="col-lg-7 col-md-7 col-sm-7">
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h3 class="panel-title">4 Squares</h3>
                  </div>
                  <table class="table table-condensed">
                    <thead>
                      <tr>
                        <th style="text-align:center;">W</th>
                        <th style="text-align:center;">L</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>0</td>
                        <td>0</td>
                      </tr>
                      <tr>
                        <td>0</td>
                        <td>1</td>
                      </tr>
                      <tr>
                        <td>0</td>
                        <td>2</td>
                      </tr>
                      <tr>
                        <td>0</td>
                        <td>3</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
              <div>
                <form class="form-inline">
                  <div class="form-group">
                    <label>Won:</label>
                    <label style="font-weight:normal;">$23</label>
                  </div>
                </form>
              </div>
              <div>
                <form class="form-inline">
                  <div class="form-group">
                    <label>Paid:</label>
                    <label style="font-weight:normal;">$20</label>
                  </div>
                </form>
              </div>
              <div>
                <form class="form-inline">
                  <div class="form-group">
                    <label>Profit:</label>
                    <label style="font-weight:normal;">$3</label>
                  </div>
                </form>
              </div>
              <div>
                    <label>Rounds:</label>
              </div>
              <div>
                    <label style="font-weight:normal;">2, 3, 4, 6</label>
              </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-7 col-md-7 col-sm-7 table-centered">
          <div class="table-responsive" style="margin-top:1em;">
            <table id="results_table" class="table table-condensed table-bordered">
              <thead>
                <tr>
                  <th class="col-lg-3 col-md-3 col-sm-3" style="text-align:left;">Name</th>
                  <th class="col-lg-1 col-md-1 col-sm-1">Round</th>
                  <th class="col-lg-1 col-md-1 col-sm-1">$ Paid</th>
                  <th class="col-lg-1 col-md-1 col-sm-1">$ Won</th>
                  <th class="col-lg-1 col-md-1 col-sm-1">Profit</th>
                </tr>
              </thead>
              <tbody>
                <% pCounter = 0 %>
                <% @participants_with_squares.each do |p_w_sq| %>
                <% participant = @participants.find(p_w_sq.id) %>
                <% pResultCount = @results.where(participant_id: participant.id).count %>
                <% pCounter += 1 %>
                <% if pResultCount > 0 %>
                <%= render partial: 'participantWithResults', locals: { participant: participant } %>
                <% else %>
                <%= render partial: 'participantWithNoResults', locals: { counter: pCounter, participant: participant } %>
                <% end %>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <p><a class='scrollToTop' href=''>return to top</a></p>
      <% else %>
      <div style='font-weight:bold;'>Please enter participants for the year.</div>
      <% end %>
      <% if Year.many? %>
      <div>Looking for results from a different year?</div>
      <br />
      <div>
        <div class="dropdown">
          <div class="btn-group">
            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
            Select Year <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" role="menu">
              <% Year.order(year: :desc).each do |y| %>
              <li><%= link_to y.year, controller: 'pages', action: 'results', year: y.year %></li>
              <% end %>
            </ul>
          </div>
          <% end %>
          <% else %>
          <div style='font-weight:bold;'>Please enter payouts for the year.</div>
          <% end %>
        </div>
      </div>
    </div>